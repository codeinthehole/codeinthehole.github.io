<!doctype html>
<!--[if lt IE 7]><html class="no-js ie6 oldie" lang="en"><![endif]-->
<!--[if IE 7]><html class="no-js ie7 oldie" lang="en"><![endif]-->
<!--[if IE 8]><html class="no-js ie8 oldie" lang="en"><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">

        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">


        
        <meta name="viewport" content="width=device-width,initial-scale=1">

        
        <link rel="stylesheet" href="/css/styles.css" type="text/css" />
        <link rel="stylesheet" href="/css/pygments.css" type="text/css" />

        
        <link rel="alternate" href="/index.xml" type="application/rss+xml" title="David Winterbottom">

        
        <link href='http://fonts.googleapis.com/css?family=Signika+Negative:600' rel='stylesheet' type='text/css' />

        
        <title>Date conditional redirects with mod_rewrite - by David Winterbottom</title>
        <meta name="author" content="David Winterbottom">
        <meta name="description" content="Using mod_rewrite to redirect based on the date">

    </head>

    <body>

        <article class="hentry" id="container">

<header>
    <div id="logo">
        <h4><a href="/" title="David Winterbottom">David Winterbottom</a></h4>
        <h5><a href="/writing/">writing</a> | 
            <a href="http://twitter.com/codeinthehole" title="Occasionally I say something interesting">tweets</a> | 
            <a href="/code/">code</a> |
            <a href="/about/">about</a></h5>
    </div>
</header>


<div id="main" role="main">

    <div id="content" class="article">

        <h1 id="article_title" class="entry-title">Date conditional redirects with mod_rewrite</h1>

        <div class="byline desktop_only">
            by <a href="/about/" class="author vcard">David Winterbottom</a>
            on <time class="published" datetime="">Friday, 7 November 2008</time>
        </div>
        <div class="byline mobile_only">
            by <a href="/about/" class="author vcard">David Winterbottom</a><br/>
            <span class="article_date">on <time class="published" datetime="">Friday, 7 November 2008</time></span>
        </div>

        <div id="article_content" class="entry-content">
            <p>The Apache module mod_rewite is capable of some very cool stuff. One
neat trick is to use the time and date variables to control redirects
and URL rewriting. This is useful if you have a URL that you don&rsquo;t want
to be exposed to the world until a certain date has passed - this could
be the case with special offers and competitions which have a one-off
static page that isn&rsquo;t to be revealed until a specified date.</p>

<p>For example, the following directives specify that a temporary 302
redirect should be issued for all requests to the URL <code>/special_offer</code>
before a certain date has passed:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">RewriteCond</span> %{TIME} &lt;20081031000000 
<span style="color: #f8f8f2">RewriteCond</span> %{REQUEST_URI} <span style="color: #e6db74">/special_offer.</span>*
<span style="color: #f8f8f2">RewriteRule</span> (.*) <span style="color: #e6db74">/offers</span> [L,R=302,QSA]
</pre></div>

<p>This means that the <code>/special_offer</code> page can be prepared and deployed
beforehand and apache will handle the transfer once the publish date has
passed. There&rsquo;s a whole load of other nifty things that can be done in a
similar vein such as returning different style sheets depending on the
time of day.</p>

<p>Digressing briefly, debugging Apache directives can be quite tricky when
you&rsquo;re playing around trying to get something to work. I find the
easiest thing to do is to redirect to a URL which contains the variable
being tested against. For example:</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">RewriteEngine</span> <span style="color: #66d9ef">On</span> 
<span style="color: #f8f8f2">RewriteCond</span> %{REQUEST_URI} <span style="color: #e6db74">/debug</span> 
<span style="color: #f8f8f2">RewriteRule</span> (.*) <span style="color: #e6db74">/debug/</span>?%{TIME}&amp;%{TIME_DAY} [L,R=302]
</pre></div>

<p>Then you can see what the values of <code>%{TIME}</code> and <code>%{TIME_DAY}</code> are from
the URL you&rsquo;ve been redirected to. There are almost certainly better
ways of doing this but this way is quick and it works.</p>

        </div>

        <div id="article_meta">
            <span class="hr">----</span>
            <p>
            
                Tagged with:
                
                 <a href="/tags/apache">apache</a>
                <br/>
            
            
                Filed in: <a href="/tips/">tips</a><br/>
            
            <a href="https://github.com/codeinthehole/codeinthehole.hugo/commits/master/content/tips/date-conditional-redirects-with-mod-rewrite.md">Revision history</a>
            </p>
            <p>
            
                Previous: <a href="/tips/creating-large-xml-files-with-php/">Creating large XML files with PHP</a><br/>
            
            
                Next: <a href="/tips/javascript-cookie-objects-using-prototype-and-json/">Javascript cookie objects using Prototype and JSON</a>
            
            </p>
            <p>
            Copyright &copy; 2005-2017 <a href="/about/">David Winterbottom</a><br/>
            Content licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>.
            </p>
        </div>
    </div>

</div>

        </article>
    </body>
</html>


